"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3107],{33107:function(e,t,l){l.r(t);var i=l(85893),n=l(1954),s=l(86886),a=l(66242),r=l(26447),d=l(15861),o=l(78445),c=l(93946),u=l(50135),h=l(49624),p=l(153),x=l(18972),v=l(83321),g=l(5152),m=l.n(g),j=l(67294),b=l(65631),y=l(82367),f=l(23871),Z=l(13033),w=l(17543),k=l(96486),C=l.n(k),L=l(50689),_=l(11163),q=l(86745),F=l(84475),O=l(7295);let S=m()(()=>Promise.all([l.e(2937),l.e(1167)]).then(l.t.bind(l,71167,23)),{loadableGenerated:{webpack:()=>[71167]},ssr:!1,loading:()=>(0,i.jsx)("p",{children:"Loading ..."})}),I=m()(()=>l.e(4645).then(l.bind(l,54645)),{loadableGenerated:{webpack:()=>[54645]},ssr:!1}),P=(e,t)=>{let l=0;for(var i,n=0;n<e.length;n++)(null===(i=e[n])||void 0===i?void 0:i.type)==t&&l++;return l},R=(e,t,l)=>{let i=0;for(var n,s=0;s<e.length&&((null===(n=e[s])||void 0===n?void 0:n.type)!=t||(i++,l!=s));s++);return i},A=()=>{var e;let{setModal:t}=(0,O.d)(),{themeMode:l,themeDnsData:g}=(0,L.K$)(),m=(0,_.useRouter)(),[Z,k]=(0,j.useState)(f.XH.brands),[A,J]=(0,j.useState)([]),[E,X]=(0,j.useState)("banner"),[z,D]=(0,j.useState)([]),[N,G]=(0,j.useState)(!0),H={banner:{type:"banner",list:[]},items:{type:"items",title:"",sub_title:"",list:[]},editor:{type:"editor",content:""}};(0,j.useEffect)(()=>{B()},[]);let U=(e,t)=>{let l=Object.keys(t);for(var i=0;i<l.length;i++)t[l[i]]&&(e[l[i]]=t[l[i]]);return e},B=async()=>{var e,t;let l=await (0,q.nB)({page:1,page_size:1e5});if((null==l?void 0:l.total)==0)return;D(null!==(e=null==l?void 0:l.content)&&void 0!==e?e:[]);let i=await (0,q.DT)({id:m.query.brand_id|(null==g?void 0:g.id)}),n=null!==(t=null==(i=U(Z,i))?void 0:i.main_obj)&&void 0!==t?t:[];k(i),J(n),G(!1)},K=e=>{let t=[...A];t.splice(e,1),J(t)},T=(e,t)=>{let l=[...A];for(var i=0;i<e.length;i++)l[t].list.push(Object.assign(e[i],{preview:URL.createObjectURL(e[i]),link:""}));J(l)},V=(e,t)=>{let l=[...A],i=C().findIndex(l[t].list.map(e=>e),{path:e.path,preview:e.preview});if(i<0)for(var n,s=0;s<l[t].list.length;s++)(null===(n=l[t].list[s])||void 0===n?void 0:n.src)==e&&(i=s);l[t].list.splice(i,1),J(l)},W=e=>{let t=[...A];t[e].list=[],J(t)},$=(e,t)=>{let l=[...A],i=[...e];l[t].list=i,J(l)},M=async()=>{let e=[...A],t=[],l=[];for(var i=0;i<e.length;i++)if((null===(n=e[i])||void 0===n?void 0:n.type)=="banner")for(var n,s,a,r,d=0;d<e[i].list.length;d++)(null===(r=e[i].list[d])||void 0===r?void 0:r.src)||(l.push({i:i,j:d}),t.push({image:e[i].list[d]}));else(null===(s=e[i])||void 0===s?void 0:s.type)=="items"||null===(a=e[i])||void 0===a||a.type;if(l.length>0){let n=await (0,q.n0)({images:t});n=null!==(o=null==n?void 0:n.data)&&void 0!==o?o:[];for(var o,c,u,i=0;i<l.length;i++)e[l[i].i].list[l[i].j]={src:null!==(u=null===(c=n[i])||void 0===c?void 0:c.url)&&void 0!==u?u:"",link:e[l[i].i].list[l[i].j].link}}let h={...Z,main_obj:e};await (0,q.ZA)({...h,id:null==g?void 0:g.id})&&(F.Am.success("성공적으로 저장 되었습니다."),window.location.href="/manager/settings/brands")},[Q,Y]=(0,j.useState)(!1),[ee,et]=(0,j.useState)([]),el=()=>{Y(!1),et([])};return(0,i.jsxs)(i.Fragment,{children:[!N&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,i.jsx)(s.ZP,{item:!0,xs:12,md:8,children:(0,i.jsx)(a.Z,{sx:{p:3,minHeight:"100%"},children:(0,i.jsxs)(r.Z,{spacing:1,children:[0==A.length&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(d.Z,{variant:"subtitle2",sx:{color:"text.secondary"},children:"콘텐츠가 없습니다."})}),A&&A.map((t,l)=>(0,i.jsxs)(i.Fragment,{children:["banner"==t.type&&("banner"==m.query.type||"all"==m.query.type||!m.query.type)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(b.X2,{style:{alignItems:"end"},children:[(0,i.jsx)(o.Z,{title:"배너슬라이드 ".concat(R(A,"banner",l)),sx:{paddingLeft:"0"}}),(0,i.jsx)(c.Z,{sx:{padding:"0.25rem",marginLeft:"auto"},onClick:()=>{K(l)},children:(0,i.jsx)(n.JO,{icon:"ph:x-bold"})})]}),(0,i.jsx)(y.Z,{multiple:!0,thumbnail:!0,onChangeLink:e=>{},files:A[l].list.map(e=>(null==e?void 0:e.src)||e),onDrop:e=>{T(e,l)},onRemove:e=>{V(e,l)},onRemoveAll:()=>{W(l)},fileExplain:{width:"(2000x850 추천)"},imageSize:{width:200,height:85}}),A[l].list&&A[l].list.map((t,n)=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(u.Z,{size:"small",label:"".concat(n+1,"번째 이미지 링크 (링크 없을 시 빈칸으로 유지)"),value:null!==(e=A[l].list[n].link)&&void 0!==e?e:"",onChange:e=>{let t=[...A];t[l].list[n].link=e.target.value,J(t)}})}))]}),"items"==t.type&&("items"==m.query.type||"all"==m.query.type||!m.query.type)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(b.X2,{style:{alignItems:"end"},children:[(0,i.jsx)(o.Z,{title:"상품슬라이드 ".concat(R(A,"items",l)),sx:{paddingLeft:"0"}}),(0,i.jsx)(c.Z,{sx:{padding:"0.25rem",marginLeft:"auto"},onClick:()=>{K(l)},children:(0,i.jsx)(n.JO,{icon:"ph:x-bold"})})]}),(0,i.jsx)(u.Z,{label:"제목",value:t.title,onChange:e=>{let t=[...A];t[l].title=e.target.value,J(t)}}),(0,i.jsx)(u.Z,{label:"부제목",value:t.sub_title,onChange:e=>{let t=[...A];t[l].sub_title=e.target.value,J(t)}}),(0,i.jsx)(h.Z,{multiple:!0,fullWidth:!0,options:z.map(e=>null==e?void 0:e.id),getOptionLabel:e=>{var t;return null===(t=C().find(z,{id:parseInt(e)}))||void 0===t?void 0:t.product_name},defaultValue:t.list,value:t.list,onChange:(e,t)=>{$(t,l)},renderInput:e=>(0,i.jsx)(u.Z,{...e,label:"선택할 상품",placeholder:"상품선택"})})]}),"editor"==t.type&&("editor"==m.query.type||"all"==m.query.type||!m.query.type)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(b.X2,{style:{alignItems:"end"},children:[(0,i.jsx)(o.Z,{title:"에디터 ".concat(R(A,"editor",l)),sx:{paddingLeft:"0"}}),(0,i.jsx)(c.Z,{sx:{padding:"0.25rem",marginLeft:"auto"},onClick:()=>{K(l)},children:(0,i.jsx)(n.JO,{icon:"ph:x-bold"})})]}),(0,i.jsx)(S,{theme:"snow",id:"content",placeholder:"",value:t.content,modules:f.JA.modules,formats:f.JA.formats,onChange:async e=>{let t=e;if(e.includes('<img src="')&&e.includes("base64,")){let l=e.split('<img src="');for(var i,n=0;n<l.length;n++)if(l[n].includes("base64,")){let e=l[n],s=(e=await e.split('"></p>'))[0];e=await (0,w._x)(e[0],"note.png");let a=new FormData;a.append("file",e);let r=await (0,q.P1)({formData:a});t=await t.replace(s,null==r?void 0:null===(i=r.data)||void 0===i?void 0:i.url)}}let s=[...A];s[l].content=t,J(s)}})]})]}))]})})}),(0,i.jsx)(s.ZP,{item:!0,xs:12,md:4,children:(0,i.jsx)(a.Z,{sx:{p:3},children:(0,i.jsxs)(r.Z,{spacing:1,children:[(0,i.jsx)(d.Z,{variant:"subtitle2",sx:{color:"text.secondary"},children:"추가할 섹션"}),(0,i.jsxs)(p.Z,{sx:{width:"100%"},value:E,onChange:e=>{X(e.target.value)},children:[(0,i.jsxs)(x.Z,{value:"banner",children:["배너슬라이드 (",P(A,"banner"),")"]}),(0,i.jsxs)(x.Z,{value:"items",children:["상품슬라이드 (",P(A,"items"),")"]}),(0,i.jsxs)(x.Z,{value:"editor",children:["에디터 (",P(A,"editor"),")"]})]}),(0,i.jsx)(v.Z,{variant:"contained",className:"content-add",onClick:()=>{el(),J([...A,H[E]])},style:{height:"48px"},children:"추가"})]})})}),(0,i.jsx)(s.ZP,{item:!0,xs:12,md:12,children:(0,i.jsx)(a.Z,{sx:{p:3},children:(0,i.jsx)(r.Z,{spacing:1,children:(0,i.jsx)(v.Z,{variant:"contained",style:{height:"48px",width:"120px",marginLeft:"auto"},onClick:()=>{t({func:()=>{M()},icon:"material-symbols:edit-outline",title:"저장 하시겠습니까?"})},children:"저장"})})})})]})}),(0,i.jsx)(I,{steps:ee,isOpen:Q,disableInteraction:!1,onRequestClose:el})]})};A.getLayout=e=>(0,i.jsx)(Z.Z,{children:e}),t.default=A}}]);